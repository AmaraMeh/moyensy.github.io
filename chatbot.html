<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Amara AI Assistant - Université de Bejaia</title>
    <meta name="description" content="Assistant IA intelligent pour les étudiants de l'Université de Bejaia. Obtenez de l'aide instantanée pour vos questions académiques.">
    <meta name="author" content="Amara Mehdi">
    <link rel="icon" type="image/png" href="assets/img/icon.png">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <style>
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --primary: 221.2 83.2% 53.3%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96.1%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 210 40% 96.1%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96.1%;
            --accent-foreground: 222.2 47.4% 11.2%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 221.2 83.2% 53.3%;
            --radius: 0.5rem;
        }

        .dark {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --primary: 217.2 91.2% 59.8%;
            --primary-foreground: 222.2 47.4% 11.2%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --accent: 217.2 32.6% 17.5%;
            --accent-foreground: 210 40% 98%;
            --border: 217.2 32.6% 17.5%;
            --input: 217.2 32.6% 17.5%;
            --ring: 224.3 76.3% 48%;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: hsl(var(--background));
            color: hsl(var(--foreground));
            min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .chat-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 1rem;
            height: calc(100vh - 4rem);
        }

        .sidebar {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .chat-main {
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .message {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            animation: fadeIn 0.3s ease;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-content {
            max-width: 70%;
            padding: 1rem;
            border-radius: var(--radius);
            background: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
        }

        .message.user .message-content {
            background: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }

        .chat-input {
            padding: 1rem;
            border-top: 1px solid hsl(var(--border));
            display: flex;
            gap: 1rem;
        }

        .chat-input input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            background: hsl(var(--input));
            color: hsl(var(--foreground));
        }

        .chat-input button {
            padding: 0.75rem 1.5rem;
            background: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-input button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .model-selector {
            padding: 0.5rem;
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            background: hsl(var(--input));
            color: hsl(var(--foreground));
            width: 100%;
        }

        .history-item {
            padding: 0.75rem;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            background: hsl(var(--secondary));
        }

        .theme-toggle {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 50;
            width: 3rem;
            height: 3rem;
            border-radius: 9999px;
            background: hsl(var(--background) / 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid hsl(var(--border));
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .typing-indicator {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
            background: hsl(var(--secondary));
            border-radius: var(--radius);
            width: fit-content;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: hsl(var(--secondary-foreground));
            border-radius: 50%;
            animation: typing 1s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="sidebar">
            <select class="model-selector" id="modelSelector">
                <!-- Models will be populated by JavaScript -->
            </select>
            <div class="history-container">
                <h3 class="text-lg font-semibold mb-2">Historique</h3>
                <div id="chatHistory" class="space-y-2">
                    <!-- History items will be populated by JavaScript -->
                </div>
            </div>
        </div>
        <div class="chat-main">
            <div class="chat-messages" id="chatMessages">
                <!-- Messages will be populated by JavaScript -->
            </div>
            <div class="chat-input">
                <input type="text" id="messageInput" placeholder="Tapez votre message..." />
                <button id="sendButton">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
    <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Initialize AOS
        AOS.init();

        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = themeToggle.querySelector('i');
        
        // Check for saved theme preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark');
            themeIcon.classList.replace('fa-moon', 'fa-sun');
        }

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark');
            const isDark = document.body.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            themeIcon.classList.replace(
                isDark ? 'fa-moon' : 'fa-sun',
                isDark ? 'fa-sun' : 'fa-moon'
            );
        });

        // Model configuration
        const models = {
            openai: Array.from({length: 50}, (_, i) => ({
                id: `amara-experimental-${(i + 1).toFixed(1)}`,
                name: `Amara Experimental ${(i + 1).toFixed(1)}`,
                provider: 'openai'
            })),
            gemini: Array.from({length: 50}, (_, i) => ({
                id: `amara-${(i + 1).toFixed(1)}`,
                name: `Amara ${(i + 1).toFixed(1)}`,
                provider: 'gemini'
            }))
        };

        // Populate model selector
        const modelSelector = document.getElementById('modelSelector');
        [...models.openai, ...models.gemini].forEach(model => {
            const option = document.createElement('option');
            option.value = model.id;
            option.textContent = model.name;
            modelSelector.appendChild(option);
        });

        // Chat functionality
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const chatMessages = document.getElementById('chatMessages');
        const chatHistory = document.getElementById('chatHistory');

        let currentChat = [];
        let chatHistoryList = [];

        function addMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : ''}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'w-8 h-8 rounded-full flex items-center justify-center';
            avatar.innerHTML = `<i class="fas ${isUser ? 'fa-user' : 'fa-robot'}"></i>`;
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            messageContent.textContent = content;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addTypingIndicator() {
            const indicator = document.createElement('div');
            indicator.className = 'typing-indicator';
            indicator.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            chatMessages.appendChild(indicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return indicator;
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Add user message
            addMessage(message, true);
            messageInput.value = '';

            // Add to current chat
            currentChat.push({ role: 'user', content: message });

            // Show typing indicator
            const typingIndicator = addTypingIndicator();

            try {
                const selectedModel = modelSelector.value;
                const model = [...models.openai, ...models.gemini].find(m => m.id === selectedModel);
                
                let response;
                if (model.provider === 'openai') {
                    response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer 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`
                        },
                        body: JSON.stringify({
                            model: 'gpt-3.5-turbo',
                            messages: currentChat
                        })
                    }).then(res => res.json());
                    
                    const aiResponse = response.choices[0].message.content;
                    addMessage(aiResponse);
                    currentChat.push({ role: 'assistant', content: aiResponse });
                } else {
                    response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer AIzaSyDRZmDyvpJ77R-BHHt9bypHRzUuVrFFWU4`
                        },
                        body: JSON.stringify({
                            contents: [{
                                parts: [{
                                    text: message
                                }]
                            }]
                        })
                    }).then(res => res.json());
                    
                    const aiResponse = response.candidates[0].content.parts[0].text;
                    addMessage(aiResponse);
                    currentChat.push({ role: 'assistant', content: aiResponse });
                }

                // Add to chat history
                const historyItem = {
                    id: Date.now(),
                    title: message.substring(0, 30) + '...',
                    messages: [...currentChat]
                };
                chatHistoryList.push(historyItem);
                updateChatHistory();
            } catch (error) {
                console.error('Error:', error);
                addMessage('Désolé, une erreur est survenue. Veuillez réessayer.');
            } finally {
                typingIndicator.remove();
            }
        }

        function updateChatHistory() {
            chatHistory.innerHTML = '';
            chatHistoryList.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.textContent = item.title;
                historyItem.addEventListener('click', () => loadChat(item));
                chatHistory.appendChild(historyItem);
            });
        }

        function loadChat(chat) {
            currentChat = [...chat.messages];
            chatMessages.innerHTML = '';
            chat.messages.forEach(msg => {
                addMessage(msg.content, msg.role === 'user');
            });
        }

        sendButton.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html> 